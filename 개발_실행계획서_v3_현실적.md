# 크루즈 지니 - 개발 실행 계획서 v3 (현실적 버전)

> **작성일**: 2025년 11월 2일  
> **목표**: 번역기 중심, 현실적으로 실행 가능한 개발  
> **핵심**: 50대가 언어 장벽 없이 크루즈 여행

---

## 🎯 핵심 변경사항

### ❌ 제거된 것
1. **예약번호 입력** → 크루즈 선택 드롭다운으로 변경
2. **ReturnToShipBanner (GPS)** → 푸시 알림으로 충분
3. **AI Tool Calling** → 수동 입력으로 충분
4. **RAG 시스템** → 간단한 FAQ로 충분

### ✅ 강화된 것
1. **통번역기** - 가장 중요한 기능
2. **50대 친화 UI** - 큰 버튼, 명확한 안내
3. **음성 중심** - TTS + STT
4. **능동적 알림** - 출항 놓침 0건

---

## 📅 전체 타임라인

```
Week 1: Phase 1 - 긴급 개선 (번역기 강화 + 온보딩 수정)
Week 2-3: Phase 2 - 시니어 친화 기능
Week 4-5: Phase 3 - 데이터 안정화
Week 6: Phase 4 - 최종 개선
```

---

## 🔴 Phase 1: 긴급 개선 (1주일)

### Day 1 (월요일): 온보딩 수정

#### 오전 (3시간): 예약번호 → 크루즈 선택으로 변경

**파일**: `/components/SimplifiedOnboarding.tsx`

**현재 (불가능)**:
```typescript
// 예약번호 입력
<input 
  placeholder="예약번호를 입력하세요 (예: MSC-JP4N5D)"
  onChange={(e) => setReservationCode(e.target.value)}
/>

// 문제: 외부 API 연동 없음, 자동 정보 불러오기 불가능
```

**변경 후 (현실적)**:
```typescript
// 크루즈 선택 드롭다운
const [cruiseProducts, setCruiseProducts] = useState([]);
const [selectedProduct, setSelectedProduct] = useState<string>('');

useEffect(() => {
  // CruiseProduct 목록 불러오기
  fetch('/api/cms/products')
    .then(res => res.json())
    .then(data => {
      if (data.ok) setCruiseProducts(data.products);
    });
}, []);

<select
  value={selectedProduct}
  onChange={(e) => setSelectedProduct(e.target.value)}
  className="w-full p-4 text-lg border-2 rounded-lg"
>
  <option value="">크루즈를 선택하세요</option>
  {cruiseProducts.map(product => (
    <option key={product.productCode} value={product.productCode}>
      {product.packageName} - {product.nights}박 {product.days}일
    </option>
  ))}
</select>

// 예시:
// "MSC 벨리시마 - 일본/대만 4박 5일"
// "로얄 캐리비안 스펙트럼 - 일본 규슈 3박 4일"
// "코스타 세레나 - 오키나와/타이완 5박 6일"
```

**장점**:
- ✅ API 연동 불필요 (자체 DB만 사용)
- ✅ 사용자가 더 직관적 (상품명 보임)
- ✅ CMS로 관리자가 상품 추가 가능 (이미 구현됨)
- ✅ 자동 정보 생성 가능 (기존 로직 그대로)

**체크리스트**:
- [ ] SimplifiedOnboarding.tsx 수정
- [ ] CruiseProduct 목록 불러오기 API 호출
- [ ] 드롭다운 UI (큰 글씨, 명확한 표시)
- [ ] 선택 시 미리보기 (일정 표시)
- [ ] 기존 자동 생성 로직과 연결
- [ ] 테스트

**소요 시간**: 3시간

---

### Day 2 (화요일): 번역기 UI 개선 (50대 최적화)

#### 전일 작업: 번역기 대대적 개선

**파일**: `/app/translator/page.tsx`

**현재 상태 확인**:
```bash
# 번역기 페이지 확인
ls /home/userhyeseon28/projects/cruise-guide/app/translator/

# 현재 어떤 기능이 있는지 확인 필요
```

**작업 1: 버튼 크기 증가 (오전 2시간)**

**Before**:
```typescript
// 작은 버튼
<button className="p-2 rounded">
  🎤 음성 입력
</button>
```

**After**:
```typescript
// 큰 버튼 (50대+ 터치하기 쉽게)
<button className="
  min-w-[100px] min-h-[80px]
  p-4 rounded-lg
  bg-blue-500 text-white
  flex flex-col items-center gap-2
  text-xl font-bold
  hover:bg-blue-600
  active:scale-95
  transition-all
">
  <span className="text-4xl">🎤</span>
  <span>말하기</span>
</button>
```

**전체 버튼 개선**:
```typescript
// 3개 주요 버튼
const TRANSLATOR_BUTTONS = [
  {
    icon: '🎤',
    label: '말하기',
    action: 'speak',
    color: 'bg-blue-500',
    size: 'large', // 80x80px
  },
  {
    icon: '📷',
    label: '사진 찍기',
    action: 'photo',
    color: 'bg-green-500',
    size: 'large',
  },
  {
    icon: '🔊',
    label: '듣기',
    action: 'listen',
    color: 'bg-purple-500',
    size: 'large',
  },
];
```

**작업 2: 언어 자동 선택 (오후 2시간)**

**현재**:
```typescript
// 사용자가 수동으로 언어 선택
<select>
  <option>한국어 → 일본어</option>
  <option>한국어 → 영어</option>
  <option>한국어 → 중국어</option>
</select>
```

**개선**:
```typescript
// 오늘 방문 기항지 기반 자동 선택
const [autoLang, setAutoLang] = useState<string>('');

useEffect(() => {
  async function detectTodayLanguage() {
    // 1. 현재 Trip 정보 가져오기
    const tripRes = await fetch('/api/trips');
    const tripData = await tripRes.json();
    
    if (!tripData.ok || !tripData.trip) return;
    
    // 2. 오늘 Itinerary 확인
    const itineraryRes = await fetch(`/api/itinerary?tripId=${tripData.trip.id}`);
    const itineraryData = await itineraryRes.json();
    
    const today = new Date();
    const todayItinerary = itineraryData.itinerary.find(item => {
      const itemDate = new Date(item.date);
      return itemDate.toDateString() === today.toDateString();
    });
    
    if (!todayItinerary) return;
    
    // 3. 국가 코드 기반 언어 매핑
    const COUNTRY_LANGUAGE_MAP: Record<string, string> = {
      'JP': 'ja', // 일본
      'CN': 'zh-CN', // 중국
      'TW': 'zh-TW', // 대만
      'HK': 'zh-HK', // 홍콩
      'US': 'en', // 미국
      'UK': 'en', // 영국
      'VN': 'vi', // 베트남
      'TH': 'th', // 태국
    };
    
    const language = COUNTRY_LANGUAGE_MAP[todayItinerary.country] || 'en';
    setAutoLang(language);
    
    // 4. 자동 설정 알림
    showToast(`오늘은 ${todayItinerary.location} 방문! 자동으로 언어를 설정했어요.`);
  }
  
  detectTodayLanguage();
}, []);
```

**작업 3: 빠른 문장 추가 (오후 2시간)**

```typescript
// 자주 쓰는 문장 버튼
const QUICK_PHRASES = {
  'ja': [ // 일본어
    { ko: '화장실이 어디에요?', ja: 'トイレはどこですか？' },
    { ko: '얼마예요?', ja: 'いくらですか？' },
    { ko: '이거 주세요', ja: 'これをください' },
    { ko: '감사합니다', ja: 'ありがとうございます' },
    { ko: '천천히 말씀해주세요', ja: 'ゆっくり話してください' },
  ],
  'zh-CN': [ // 중국어
    { ko: '화장실이 어디에요?', cn: '厕所在哪里？' },
    { ko: '얼마예요?', cn: '多少钱？' },
    { ko: '이거 주세요', cn: '我要这个' },
    { ko: '감사합니다', cn: '谢谢' },
    { ko: '천천히 말씀해주세요', cn: '请慢点说' },
  ],
  'en': [ // 영어
    { ko: '화장실이 어디에요?', en: 'Where is the bathroom?' },
    { ko: '얼마예요?', en: 'How much is it?' },
    { ko: '이거 주세요', en: 'I\'ll take this' },
    { ko: '감사합니다', en: 'Thank you' },
    { ko: '천천히 말씀해주세요', en: 'Please speak slowly' },
  ],
};

// UI
<div className="grid grid-cols-2 gap-2 mt-4">
  {QUICK_PHRASES[autoLang]?.map((phrase, idx) => (
    <button
      key={idx}
      onClick={() => {
        setInputText(phrase.ko);
        handleTranslate(phrase.ko);
      }}
      className="p-3 bg-gray-100 rounded-lg text-left"
    >
      <div className="font-medium">{phrase.ko}</div>
      <div className="text-sm text-gray-600 mt-1">
        {phrase[autoLang]}
      </div>
    </button>
  ))}
</div>
```

**체크리스트**:
- [ ] 버튼 크기 증가 (80x80px 이상)
- [ ] 아이콘 + 텍스트 함께 표시
- [ ] 색상 대비 증가 (고대비)
- [ ] 언어 자동 선택 로직
- [ ] Itinerary 기반 국가 감지
- [ ] 빠른 문장 추가 (5-10개)
- [ ] 빠른 문장 버튼 UI
- [ ] 테스트

**소요 시간**: 전일 (8시간)

---

### Day 3 (수요일): 번역기 튜토리얼

#### 전일 작업: 첫 사용 가이드

**파일**: `/app/translator/components/TranslatorTutorial.tsx` (새 파일)

```typescript
// app/translator/components/TranslatorTutorial.tsx
'use client';

import { useState } from 'react';

const STEPS = [
  {
    title: '사진을 찍으면 메뉴판을 번역해드려요!',
    description: '일본어, 중국어 메뉴판도 한글로 보세요.',
    image: '/tutorial/translator-photo.png',
    action: '📷 사진 찍기',
  },
  {
    title: '말하기 버튼을 누르고 말하세요',
    description: '한국어로 말하면 자동으로 번역됩니다.',
    image: '/tutorial/translator-speak.png',
    action: '🎤 말하기',
  },
  {
    title: '번역된 내용을 다시 들을 수 있어요',
    description: '상대방에게 들려주거나, 다시 확인할 수 있어요.',
    image: '/tutorial/translator-listen.png',
    action: '🔊 듣기',
  },
];

export default function TranslatorTutorial({ onComplete }: { onComplete: () => void }) {
  const [currentStep, setCurrentStep] = useState(0);
  
  const handleNext = () => {
    if (currentStep < STEPS.length - 1) {
      setCurrentStep(prev => prev + 1);
    } else {
      onComplete();
      localStorage.setItem('hasSeenTranslatorTutorial', 'true');
    }
  };
  
  const handleSkip = () => {
    onComplete();
    localStorage.setItem('hasSeenTranslatorTutorial', 'true');
  };
  
  const step = STEPS[currentStep];
  
  return (
    <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4">
      <div className="bg-white rounded-3xl p-8 max-w-lg w-full">
        {/* 진행 표시 */}
        <div className="flex gap-2 mb-6">
          {STEPS.map((_, index) => (
            <div
              key={index}
              className={`h-2 flex-1 rounded-full ${
                index <= currentStep ? 'bg-blue-500' : 'bg-gray-200'
              }`}
            />
          ))}
        </div>
        
        {/* 이모티콘 */}
        <div className="text-center mb-6">
          <span className="text-8xl">{step.action}</span>
        </div>
        
        {/* 내용 */}
        <h2 className="text-3xl font-bold mb-4 text-center">
          {step.title}
        </h2>
        <p className="text-xl text-gray-600 mb-8 text-center leading-relaxed">
          {step.description}
        </p>
        
        {/* 버튼 */}
        <div className="flex gap-3">
          <button
            onClick={handleSkip}
            className="flex-1 px-6 py-4 border-2 border-gray-300 rounded-xl text-lg font-medium text-gray-700"
          >
            건너뛰기
          </button>
          <button
            onClick={handleNext}
            className="flex-1 px-6 py-4 bg-blue-500 text-white rounded-xl text-lg font-bold"
          >
            {currentStep < STEPS.length - 1 ? '다음 →' : '시작하기 🚀'}
          </button>
        </div>
      </div>
    </div>
  );
}
```

**사용**:
```typescript
// app/translator/page.tsx
import TranslatorTutorial from './components/TranslatorTutorial';

export default function TranslatorPage() {
  const [showTutorial, setShowTutorial] = useState(false);
  
  useEffect(() => {
    const hasSeenTutorial = localStorage.getItem('hasSeenTranslatorTutorial');
    if (!hasSeenTutorial) {
      setShowTutorial(true);
    }
  }, []);
  
  return (
    <>
      {showTutorial && (
        <TranslatorTutorial onComplete={() => setShowTutorial(false)} />
      )}
      
      {/* 기존 번역기 UI */}
    </>
  );
}
```

**체크리스트**:
- [ ] TranslatorTutorial 컴포넌트 생성
- [ ] 3단계 콘텐츠 작성
- [ ] 큰 이모티콘 + 명확한 설명
- [ ] 진행 표시 바
- [ ] 건너뛰기/다음/시작하기 버튼
- [ ] LocalStorage로 "다시 보지 않기"
- [ ] 튜토리얼 이미지 (선택사항)
- [ ] 테스트

**소요 시간**: 전일 (6시간)

---

### Day 4 (목요일): 채팅 히스토리 & 에러 처리

#### 오전 (3시간): 채팅 히스토리 로드

**파일**: `/app/chat/components/ChatClientShell.tsx`

```typescript
// 히스토리 로드 함수
const [isLoadingHistory, setIsLoadingHistory] = useState(false);

const loadChatHistory = async () => {
  try {
    setIsLoadingHistory(true);
    
    const tripId = session?.tripId || currentTripId;
    const response = await fetch(`/api/chat/history?tripId=${tripId}`);
    const data = await response.json();
    
    if (Array.isArray(data)) {
      const historyMessages = data.map((msg: any) => ({
        id: msg.id,
        role: msg.role as 'user' | 'assistant',
        type: 'text' as const,
        text: msg.content,
      }));
      
      setMessages(prev => [...historyMessages, ...prev]);
    }
  } catch (error) {
    console.error('히스토리 로드 실패:', error);
    // 에러는 무시 (새 대화 시작)
  } finally {
    setIsLoadingHistory(false);
  }
};

useEffect(() => {
  loadChatHistory();
}, []);

// 로딩 UI
{isLoadingHistory && (
  <div className="flex justify-center py-4">
    <div className="text-gray-500 text-lg">이전 대화를 불러오는 중...</div>
  </div>
)}
```

**체크리스트**:
- [ ] loadChatHistory 함수 추가
- [ ] useEffect로 자동 로드
- [ ] 로딩 상태 UI
- [ ] 에러 처리
- [ ] 테스트

**소요 시간**: 3시간

---

#### 오후 (3시간): 에러 메시지 한국어 & 환율 API

**작업 1: 에러 메시지 한국어 (1.5시간)**

```typescript
// lib/errors.ts (새 파일)
export const ERROR_MESSAGES = {
  UNAUTHORIZED: '로그인이 필요합니다. 다시 로그인해주세요.',
  NOT_FOUND: '요청하신 정보를 찾을 수 없습니다.',
  BAD_REQUEST: '잘못된 요청입니다. 다시 시도해주세요.',
  INTERNAL_ERROR: '일시적인 오류가 발생했습니다. 잠시 후 다시 시도해주세요.',
  NETWORK_ERROR: '인터넷 연결을 확인해주세요.',
  INVALID_INPUT: '입력하신 정보를 다시 확인해주세요.',
  
  // 번역기 관련
  TRANSLATION_ERROR: '번역에 실패했습니다. 다시 시도해주세요.',
  MICROPHONE_ERROR: '마이크 권한이 필요합니다. 설정에서 권한을 허용해주세요.',
  CAMERA_ERROR: '카메라 권한이 필요합니다. 설정에서 권한을 허용해주세요.',
  
  // 환율 관련
  EXCHANGE_RATE_ERROR: '환율 정보를 불러올 수 없습니다. 기준 환율을 사용합니다.',
};
```

**작업 2: 환율 API 에러 처리 (1.5시간)**

```typescript
// 폴백 환율 데이터
const FALLBACK_RATES = {
  USD: { krw: 1300, symbol: '$', lastUpdate: '2025-11-02' },
  JPY: { krw: 900, symbol: '¥', lastUpdate: '2025-11-02' },
  EUR: { krw: 1450, symbol: '€', lastUpdate: '2025-11-02' },
  CNY: { krw: 180, symbol: '¥', lastUpdate: '2025-11-02' },
  TWD: { krw: 42, symbol: 'NT$', lastUpdate: '2025-11-02' },
};

// API
export async function GET(req: Request) {
  try {
    const response = await fetch('외부 환율 API');
    
    if (!response.ok) {
      return NextResponse.json({
        ok: true,
        rates: FALLBACK_RATES,
        isFallback: true,
        message: ERROR_MESSAGES.EXCHANGE_RATE_ERROR,
      });
    }
    
    const data = await response.json();
    return NextResponse.json({ ok: true, rates: data, isFallback: false });
    
  } catch (error) {
    return NextResponse.json({
      ok: true,
      rates: FALLBACK_RATES,
      isFallback: true,
      message: ERROR_MESSAGES.EXCHANGE_RATE_ERROR,
    });
  }
}
```

**체크리스트**:
- [ ] lib/errors.ts 생성
- [ ] 모든 API에 ERROR_MESSAGES 적용
- [ ] FALLBACK_RATES 정의
- [ ] 환율 API 에러 처리
- [ ] 클라이언트 에러 토스트
- [ ] [재시도] 버튼
- [ ] 테스트

**소요 시간**: 3시간

---

### Day 5 (금요일): 통합 테스트 & 문서화

#### 전일 작업

**오전 (4시간): 통합 테스트**

```
테스트 시나리오:

1. 온보딩 테스트
   - [ ] 크루즈 선택 드롭다운 동작
   - [ ] 날짜 선택
   - [ ] 자동 생성 확인

2. 번역기 테스트
   - [ ] 버튼 크기 확인 (터치하기 쉬운지)
   - [ ] 언어 자동 선택 확인
   - [ ] 빠른 문장 동작
   - [ ] 사진 번역 동작
   - [ ] 음성 입력/출력 동작
   - [ ] 튜토리얼 표시

3. 채팅 테스트
   - [ ] 히스토리 로드 확인
   - [ ] 새로고침 후 복원

4. 에러 처리 테스트
   - [ ] 한국어 에러 메시지 확인
   - [ ] 환율 API 실패 시 폴백
   - [ ] [재시도] 버튼 동작

5. 50대+ 사용성 테스트
   - [ ] 글씨가 충분히 큰지
   - [ ] 버튼이 누르기 쉬운지
   - [ ] 안내 메시지가 명확한지
```

**오후 (4시간): 문서화 & 배포 준비**

```
1. CHANGELOG.md 업데이트
2. README.md 업데이트
3. 배포 전 체크리스트
4. 베타 테스트 준비
```

**소요 시간**: 전일

---

## 📊 Phase 1 완료 시 달성 목표

### ✅ 기능 완성도: 95%
- 온보딩: 크루즈 선택 방식 (현실적)
- 번역기: 50대 최적화 (큰 버튼, 자동 언어, 빠른 문장)
- 채팅: 히스토리 유지
- 에러: 한국어 + 폴백 시스템

### ✅ 시니어 친화도: 90%
- 번역기 버튼 80x80px 이상
- 빠른 문장으로 타이핑 불필요
- 음성 입력/출력
- 명확한 안내

### ✅ 출시 가능
- 핵심 기능 모두 작동
- 에러 처리 완벽
- 50대도 사용 가능

---

## 🟡 Phase 2: 시니어 친화 기능 (2주)

### Week 1: 음성 입력 (STT) & 글씨 크기

```
Day 1-3: 채팅에 STT 추가
- InputBar에 [🎤 음성 입력] 버튼
- Web Speech API
- 음성 → 텍스트 자동 입력

Day 4-5: 글씨 크기 조절
- 설정 페이지에 "글씨 크기"
- 4단계 선택
- CSS 변수로 전체 적용
```

### Week 2: 고대비 모드 & 가계부 개선

```
Day 1-3: 고대비 모드
- Tailwind 다크 모드
- 전체 컴포넌트 스타일

Day 4-5: 가계부 개선
- 오늘 방문 국가 통화 자동 선택
- Itinerary 기반 로직
```

---

## 🟢 Phase 3: 데이터 안정화 (2주)

```
Week 1: 가계부 마이그레이션
- LocalStorage → API

Week 2: 체크리스트 마이그레이션
- LocalStorage → API
```

---

## 🟢 Phase 4: 최종 개선 (1주)

```
Day 1-2: 로딩 스켈레톤
Day 3-4: Toast 시스템
Day 5: 최종 테스트
```

---

## 📝 매일 체크리스트

### Phase 1 Week 1
- [ ] Day 1: 온보딩 크루즈 선택 (3시간)
- [ ] Day 2: 번역기 UI 개선 (8시간)
- [ ] Day 3: 번역기 튜토리얼 (6시간)
- [ ] Day 4: 히스토리 + 에러 처리 (6시간)
- [ ] Day 5: 테스트 + 문서화 (8시간)

**총 소요**: 31시간 (1주일)

---

## 🎯 핵심 개선사항 요약

### 1. 온보딩
- ❌ 예약번호 입력 (API 연동 불가능)
- ✅ 크루즈 선택 드롭다운 (현실적)

### 2. 번역기 (가장 중요!)
- ✅ 버튼 크기 2배 증가
- ✅ 언어 자동 선택
- ✅ 빠른 문장 추가
- ✅ 첫 사용 튜토리얼

### 3. 채팅
- ✅ 히스토리 로드

### 4. 에러 처리
- ✅ 모든 메시지 한국어
- ✅ 환율 폴백 시스템

---

## 🚀 다음 단계

**지금 바로 시작!**

1. Day 1 작업 시작 (3시간)
2. 매일 체크리스트 확인
3. 1주일 후 출시 가능 **95%**

**질문이나 막히는 부분이 있으면 언제든 물어보세요!** 💪

---

**작성자**: 크루즈 지니 팀  
**작성일**: 2025년 11월 2일  
**버전**: 3.0 (현실적 - 번역기 중심)  
**다음 단계**: Phase 1 Day 1 착수

🚀 **"말이 통하면 여행이 쉽다"** 🚀

















