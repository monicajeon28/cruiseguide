<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI í¬ë£¨ì¦ˆ ê°€ì´ë“œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/react-markdown@8.0.0/react-markdown.min.js"></script>
    <script src="https://unpkg.com/remark-gfm@3.0.1/remark-gfm.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        .chat-bubble-user { animation: slideInUser 0.3s ease-out forwards; }
        .chat-bubble-assistant { animation: slideInAssistant 0.3s ease-out forwards; }
        @keyframes slideInUser { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes slideInAssistant { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        .chat-bubble a { pointer-events: auto; }
        .chat-bubble { position: relative; z-index: 0; }
        .chat-overlay { pointer-events: none; }
        .chat-overlay * { pointer-events: none; }
        /* ë§í’ì„  ë§í¬ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .chat-bubble a.chat-link {
          text-decoration: underline;
          cursor: pointer;
          pointer-events: auto;          /* ë§í¬ ìì²´ ì´ë²¤íŠ¸ í™œì„±í™” */
        }

        /* ë§í’ì„  ì»¨í…Œì´ë„ˆê°€ í´ë¦­ì„ ê°€ë¡œì±„ì§€ ì•Šë„ë¡ */
        .chat-bubble {
          pointer-events: auto;
          background-color: transparent; /* íˆ¬ëª…ë„ ê²½ê³  í•´ê²° */
        }

        /* ì±„íŒ… ìœ„ë¥¼ ë®ëŠ” ìƒë‹¨ ê³ ì • ë°”/ì˜¤ë²„ë ˆì´ê°€ ìˆìœ¼ë©´ ê¼­ ë¹„í™œì„±í™” */
        .header-overlay,
        .toast-overlay {
          pointer-events: none;
        }

        /* ë§í’ì„  ì•ˆì— ë²„íŠ¼/ì¸ë„¤ì¼ ê·¸ë¦¬ë“œ í´ë¦­ ì˜ ë˜ë„ë¡ */
        .chat-bubble .btn,
        .chat-bubble .thumb {
          pointer-events: auto;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div id="root" class="w-full h-full"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect, useCallback } = React;

        // --- ë°ì´í„°ë² ì´ìŠ¤ ---
        const IMAGE_DB = {
          "MSCë²¨ë¦¬ì‹œë§ˆ": ["/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/MSCë²¨ë¦¬ì‹œë§ˆ/MSC ë²¨ë¦¬ì‹œë§ˆ (1).png", "/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/MSCë²¨ë¦¬ì‹œë§ˆ/MSC ë²¨ë¦¬ì‹œë§ˆ (2).png", "/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/MSCë²¨ë¦¬ì‹œë§ˆ/MSC ë²¨ë¦¬ì‹œë§ˆ (3).png"],
          "ì½”ìŠ¤íƒ€ì„¸ë ˆë‚˜": ["/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/ì½”ìŠ¤íƒ€ì„¸ë ˆë‚˜/ì½”ìŠ¤íƒ€ì„¸ë ˆë‚˜.jpg", "/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/ì½”ìŠ¤íƒ€ì„¸ë ˆë‚˜/ì½”ìŠ¤íƒ€ì„¸ë ˆë‚˜í˜¸ (1).jpg"],
          "ì¼ë³¸ ë¯¸ì•¼ì½”ì§€ë§ˆ": ["/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/ì¼ë³¸ ë¯¸ì•¼ì½”ì§€ë§ˆ/ë¯¸ì•¼ì½”ì§€ë§ˆ 1  (1).png", "/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/ì¼ë³¸ ë¯¸ì•¼ì½”ì§€ë§ˆ/ì¼ë³¸ ë¯¸ì•¼ì½”ì§€ë§ˆ (1).jpg"],
          "ê³ ê° í›„ê¸° ìë£Œ": ["/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/ê³ ê° í›„ê¸° ìë£Œ/ì½”ìŠ¤íƒ€ ì„¸ë ˆë‚˜ ê°œê·¸ë§¨ í›„ê¸°.jpg", "/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/ê³ ê° í›„ê¸° ìë£Œ/ì½”ìŠ¤íƒ€ ì„¸ë ˆë‚˜ ê³µì—° í›„ê¸°.jpg"],
          "ë¡œì–„ìºë¦¬ë¹„ì•ˆ ìŠ¤í™íŠ¸ëŸ¼": ["/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/ë¡œì–„ìºë¦¬ë¹„ì•ˆ ìŠ¤í™íŠ¸ëŸ¼/ë¡œì–„ ìŠ¤í™íŠ¸ëŸ¼ (1).png", "/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/ë¡œì–„ìºë¦¬ë¹„ì•ˆ ìŠ¤í™íŠ¸ëŸ¼/ë¡œì–„ ìŠ¤í™íŠ¸ëŸ¼ (2).png"],
          "í™ì½©": ["/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/í™ì½©/í™ì½© 1881 í—¤ë¦¬í‹°ì§€ ì‡¼í•‘ëª° 2.jpg", "/í¬ë£¨ì¦ˆì •ë³´ì‚¬ì§„/í™ì½©/í™ì½© Kë®¤ì œì•„.jpg"]
        };

        const LOCATIONS_DB = {
            "terminals": {
                "í™ì½© ì¹´ì´íƒ í¬ë£¨ì¦ˆ í„°ë¯¸ë„": { name: "í™ì½© ì¹´ì´íƒ í¬ë£¨ì¦ˆ í„°ë¯¸ë„", map_query: "Kai Tak Cruise Terminal, Hong Kong" },
                "ë„ì¿„ êµ­ì œ í¬ë£¨ì¦ˆ í„°ë¯¸ë„": { name: "ë„ì¿„ êµ­ì œ í¬ë£¨ì¦ˆ í„°ë¯¸ë„", map_query: "Tokyo International Cruise Terminal" }
            },
            "airports": {
                "ì¸ì²œêµ­ì œê³µí•­": { name: "ì¸ì²œêµ­ì œê³µí•­", map_query: "Incheon International Airport" },
                "í™ì½© êµ­ì œê³µí•­": { name: "í™ì½© êµ­ì œê³µí•­", map_query: "Hong Kong International Airport" }
            },
            "stations": { "ë„ì¿„ì—­": { name: "ë„ì¿„ì—­", map_query: "Tokyo Station" } },
            "aliases": {
                "ì¹´ì´íƒ": "í™ì½© ì¹´ì´íƒ í¬ë£¨ì¦ˆ í„°ë¯¸ë„", "í™ì½©ê³µí•­": "í™ì½© êµ­ì œê³µí•­", "ì¸ì²œê³µí•­": "ì¸ì²œêµ­ì œê³µí•­",
                "ì‚¬ì„¸ë³´": "ì‚¬ì„¸ë³´ ì‹ í•­êµ¬", "ë²¨ë¦¬ì‹œë§ˆ": "MSCë²¨ë¦¬ì‹œë§ˆ", "ë¯¸ì•¼ì½”ì§€ë§ˆ": "ì¼ë³¸ ë¯¸ì•¼ì½”ì§€ë§ˆ",
                "ìŠ¤í™íŠ¸ëŸ¼": "ë¡œì–„ìºë¦¬ë¹„ì•ˆ ìŠ¤í™íŠ¸ëŸ¼", "í›„ê¸°": "ê³ ê° í›„ê¸° ìë£Œ"
            }
        };

        // --- ì»´í¬ë„ŒíŠ¸ë“¤ ---
        const MessageContent = ({ content }) => {
            if (typeof content !== 'string' || !content) return null;
            return (
                <div className="text-base whitespace-pre-wrap break-words">
                    <ReactMarkdown
                        remarkPlugins={[remarkGfm]}
                        components={{
                            a: ({node, ...props}) => (
                                <a
                                    {...props}
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    className="chat-link"
                                    onClick={(e) => {
                                        e.stopPropagation(); // ìƒìœ„ í´ë¦­í•¸ë“¤ëŸ¬ ì°¨ë‹¨
                                    }}
                                />
                            ),
                        }}
                    >
                        {content}
                    </ReactMarkdown>
                </div>
            );
        };

        const ChatUI = ({ messages, isLoading, scrollRef, onImageClick, onOpenPhotoAlbum }) => {
          return (
            <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 text-gray-800 text-lg leading-relaxed scrollbar-hide" ref={scrollRef}>
                {messages.map((msg) => (
                  <div key={msg.id} className={`flex items-end gap-2 mb-4 ${msg.type === 'user' ? 'justify-end chat-bubble-user' : 'justify-start chat-bubble-assistant'}`}>
                    {msg.type === 'assistant' && (
                      <div className="w-10 h-10 rounded-full bg-white flex items-center justify-center flex-shrink-0 mr-2 shadow-sm border border-gray-200">
                        <span className="text-2xl">ğŸ§</span>
                      </div>
                    )}
                    <div className={`max-w-md px-4 py-3 rounded-2xl shadow-md ${msg.type === 'user' ? 'bg-blue-600 text-white rounded-br-none' : 'bg-white text-gray-800 rounded-bl-none'}`}>
                      <MessageContent content={msg.content} />

                      {/* [NEW] ì„ íƒì§€ ë²„íŠ¼ */}
                      {msg.chips && msg.chips.length > 0 && (
                        <div className="mt-3 flex flex-wrap gap-2">
                          {msg.chips.map((c, i) => (
                            <button
                              key={i}
                              className="px-3 py-1.5 rounded-full border text-sm bg-blue-50 hover:bg-blue-100"
                              onClick={(e) => { e.stopPropagation(); handleSendMessage(c.payload || c.label); }}
                            >
                              {c.label}
                            </button>
                          ))}
                        </div>
                      )}

                      {msg.photoAlbum && msg.photoAlbum.length > 0 && (
                        <div className="mt-2">
                          <div className="grid grid-cols-3 gap-2">
                            {msg.photoAlbum.slice(0, 9).map((media, index) => (
                              <div key={index} className="aspect-square bg-gray-200 rounded-lg overflow-hidden cursor-pointer hover:opacity-80 transition-opacity" onClick={() => onImageClick(msg.photoAlbum, index)}>
                                  <img src={media} alt={`ì‚¬ì§„ ${index + 1}`} className="w-full h-full object-cover" onError={(e) => { e.currentTarget.src = 'https://placehold.co/100x100/EEE/31343C?text=Error'; }}/>
                              </div>
                            ))}
                          </div>
                          {msg.photoAlbum.length > 9 && (
                            <button onClick={() => onOpenPhotoAlbum(msg.photoAlbum)} className="mt-2 w-full text-center text-sm bg-blue-100 text-blue-800 px-3 py-2 rounded-lg hover:bg-blue-200 flex items-center justify-center gap-2">
                              <i className="fa-regular fa-images"></i>
                              <span>{msg.photoAlbum.length}ì¥ì˜ ì‚¬ì§„ ëª¨ë‘ ë³´ê¸°</span>
                            </button>
                          )}
                        </div>
                      )}
                    </div>
                  </div>
                ))}
                {isLoading && (
                  <div className="flex items-end gap-2 justify-start chat-bubble-assistant">
                     <div className="w-10 h-10 rounded-full bg-white flex items-center justify-center flex-shrink-0 mr-2 shadow-sm border border-gray-200"> <span className="text-2xl">ğŸ§</span></div>
                    <div className="bg-white text-gray-800 px-4 py-2 rounded-2xl shadow rounded-bl-none"><p className="text-base animate-pulse">ì§€ë‹ˆê°€ ì°¾ê³  ìˆì–´ìš”... ğŸ§â€â™‚ï¸</p></div>
                  </div>
                )}
            </div>
          );
        };

        const PhotoAlbumModal = ({ isOpen, onClose, media, onImageClick }) => {
          if (!isOpen) return null;
          return (
            <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50" onClick={onClose}>
              <div className="bg-white rounded-lg p-4 max-w-4xl w-11/12 max-h-[90vh] overflow-y-auto" onClick={(e) => e.stopPropagation()}> 
                <div className="flex justify-between items-center mb-4"> <h2 className="text-2xl font-bold">ì‚¬ì§„ ì•¨ë²”</h2> <button onClick={onClose} className="text-2xl font-bold">&times;</button> </div>
                <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                  {media.map((item, index) => (
                    <div key={index} className="aspect-square bg-gray-200 rounded-lg overflow-hidden cursor-pointer" onClick={() => onImageClick(index)}>
                      <img src={item} alt={`ë¯¸ë””ì–´ ${index + 1}`} className="w-full h-full object-cover" onError={(e) => { e.currentTarget.src = 'https://placehold.co/200x200/EEE/31343C?text=Error'; }}/>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          );
        };

        const ImageViewerModal = ({ isOpen, onClose, images, currentIndex, setCurrentIndex }) => {
          if (!isOpen || !images || images.length === 0) return null;
          const goToPrevious = () => setCurrentIndex((prev) => (prev === 0 ? images.length - 1 : prev - 1));
          const goToNext = () => setCurrentIndex((prev) => (prev === images.length - 1 ? 0 : prev + 1));
          return (
            <div className="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50" onClick={onClose}>
              <button className="absolute top-1/2 left-4 text-white text-4xl p-2" onClick={(e) => { e.stopPropagation(); goToPrevious(); }}>&#10094;</button>
                <img src={images[currentIndex]} className="max-w-[90vw] max-h-[90vh] object-contain" onError={(e) => { e.currentTarget.src = 'https://placehold.co/800x600/000/FFF?text=Error'; }}/>
              <button className="absolute top-1/2 right-4 text-white text-4xl p-2" onClick={(e) => { e.stopPropagation(); goToNext(); }}>&#10095;</button>
              <button className="absolute top-4 right-4 text-white text-4xl" onClick={onClose}>&times;</button>
            </div>
          );
        };
        
        const App = () => {
            const [messages, setMessages] = useState([]);
            const [isLoading, setIsLoading] = useState(false);
            const [isPhotoAlbumOpen, setIsPhotoAlbumOpen] = useState(false);
            const [photoAlbumMedia, setPhotoAlbumMedia] = useState([]);
            const [isImageViewerOpen, setIsImageViewerOpen] = useState(false);
            const [galleryImages, setGalleryImages] = useState([]);
            const [currentImageIndex, setCurrentImageIndex] = useState(0);
            const scrollRef = useRef(null);

            useEffect(() => { if (scrollRef.current) scrollRef.current.scrollTop = scrollRef.current.scrollHeight; }, [messages]);

            const findLocationName = (text) => {
                const normalizedText = text.toLowerCase().replace(/\s+/g, '');
                let bestMatch = null;
                let highestScore = 0;

                const allLocationNames = [
                    ...Object.keys(LOCATIONS_DB.aliases),
                    ...Object.keys(LOCATIONS_DB.terminals),
                    ...Object.keys(LOCATIONS_DB.airports),
                    ...Object.keys(LOCATIONS_DB.stations)
                ];

                for (const name of allLocationNames) {
                    const normalizedName = name.toLowerCase().replace(/\s+/g, '');
                    if (normalizedText.includes(normalizedName)) {
                        const score = normalizedName.length;
                        if (score > highestScore) {
                            highestScore = score;
                            bestMatch = name;
                        }
                    }
                }
                return LOCATIONS_DB.aliases[bestMatch] || bestMatch;
            };

            const getMapQuery = (name) => {
                 for (const category of ['terminals', 'airports', 'stations']) {
                    if (LOCATIONS_DB[category][name]) {
                        return LOCATIONS_DB[category][name].map_query;
                    }
                }
                return name; // Fallback to the name itself
            };
            
            const getGenieResponse = (message) => {
                const isNavQuery = /ì–´ë–»ê²Œ ê°€|ê°€ëŠ” ê¸¸|ê¸¸ì°¾ê¸°|ë„¤ë¹„|ì§€ë„|ë§µ|ë§›ì§‘|ìŠˆí¼|ê·¼ì²˜/i.test(message);
                const isPhotoQuery = /ë³´ì—¬ì¤˜|ì‚¬ì§„|ì´ë¯¸ì§€|ì–´ë–»ê²Œ ìƒê²¼/i.test(message);
                
                if (isNavQuery) {
                    const originMatch = message.match(/(.+)ì—ì„œ/);
                    let originText = originMatch ? originMatch[1].trim() : "ë‚´ ìœ„ì¹˜";
                    if (["ë‚´ ìœ„ì¹˜", "í˜„ì¬ ìœ„ì¹˜", "ì—¬ê¸°"].includes(originText)) originText = "My Location";

                    const destinationText = message.split('ì—ì„œ').pop().split('ê¹Œì§€')[0].replace(/ê°€ëŠ” ê¸¸|ê¸¸ì°¾ê¸°|ë„¤ë¹„|ì§€ë„|ë§µ|ë§›ì§‘|ìŠˆí¼|ê·¼ì²˜/i, '').trim();
                    let destinationName = findLocationName(destinationText) || destinationText;
                    let mapQuery = getMapQuery(destinationName);
                    let originQuery = originText === "My Location" ? "" : (getMapQuery(findLocationName(originText)) || originText);

                    let responseMessage;
                    if (/ë§›ì§‘|ìŠˆí¼|ë§ˆíŠ¸/i.test(message)) {
                        const keyword = message.match(/ë§›ì§‘|ìŠˆí¼|ë§ˆíŠ¸/i)[0];
                        const nearByQuery = `${keyword} near ${mapQuery || originQuery}`;
                        const nearByUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(nearByQuery)}`;
                        responseMessage = `${destinationName || originText} ê·¼ì²˜ '${keyword}' ëª©ë¡ì´ì—ìš”.\n\n[ì§€ë„ì—ì„œ ì „ì²´ ë³´ê¸°](${nearByUrl})`;
                    } else {
                        const drivingUrl = `https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(originQuery)}&destination=${encodeURIComponent(mapQuery)}&travelmode=driving`;
                        const transitUrl = `https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(originQuery)}&destination=${encodeURIComponent(mapQuery)}&travelmode=transit`;
                        responseMessage = `'${originText}'ì—ì„œ '${destinationName}'(ìœ¼)ë¡œ ê°€ëŠ” ê¸¸ì´ì—ìš”.\n\n[ğŸš— ìë™ì°¨ ê¸¸ì°¾ê¸°](${drivingUrl})\n\n[ğŸšŒ ëŒ€ì¤‘êµí†µ ê¸¸ì°¾ê¸°](${transitUrl})`;
                    }
                    return { content: responseMessage, source: 'nav_success' };
                }

                if (isPhotoQuery) {
                    const normalizedText = message.toLowerCase().replace(/ë³´ì—¬ì¤˜|ì‚¬ì§„|ì´ë¯¸ì§€|ì–´ë–»ê²Œ ìƒê²¼/g, '').replace(/\s+/g, '').trim();
                    let bestMatch = null;
                    let highestScore = 0;

                    const allSearchableNames = [...Object.keys(IMAGE_DB), ...Object.keys(LOCATIONS_DB.aliases)];
                    for (const name of allSearchableNames) {
                        const normalizedName = name.toLowerCase().replace(/\s+/g, '');
                        if (normalizedText.includes(normalizedName)) {
                            const score = normalizedName.length;
                            if (score > highestScore) {
                                highestScore = score;
                                bestMatch = name;
                            }
                        }
                    }

                    const folderName = LOCATIONS_DB.aliases[bestMatch] || bestMatch;

                    if (folderName && IMAGE_DB[folderName]) {
                         return {
                            content: `ë„¤, '${folderName}' ê´€ë ¨ ì‚¬ì§„ ${IMAGE_DB[folderName].length}ì¥ì„ ì°¾ì•˜ì–´ìš”.`,
                            photoAlbum: IMAGE_DB[folderName],
                            source: 'photo_success',
                        };
                    }
                    return { content: "ì–´ë–¤ ì‚¬ì§„ì„ ë³´ì—¬ë“œë¦´ê¹Œìš”? í¬ë£¨ì¦ˆë‚˜ ê¸°í•­ì§€ ì´ë¦„ì„ ë§ì”€í•´ì£¼ì„¸ìš”. (ì˜ˆ: ë²¨ë¦¬ì‹œë§ˆ ì‚¬ì§„ ë³´ì—¬ì¤˜)", source: 'photo_fail_not_found' };
                }
                 return { content: "ì£„ì†¡í•©ë‹ˆë‹¤. ì•„ì§ í•™ìŠµ ì¤‘ì´ë¼ ë‹µë³€í•˜ê¸° ì–´ë ¤ìš´ ì§ˆë¬¸ì´ì—ìš”. \n- **ì‚¬ì§„**: 'ë²¨ë¦¬ì‹œë§ˆ ë³´ì—¬ì¤˜'\n- **ê¸¸ì°¾ê¸°**: 'í™ì½©ê³µí•­ì—ì„œ ì¹´ì´íƒê¹Œì§€'", source: 'fallback' };
            };
            
            const handleSendMessage = async (message) => {
                if (!message.trim() || isLoading) return;
                setMessages(prev => [...prev, { id: Date.now(), type: 'user', content: message }]);
                setIsLoading(true);
                await new Promise(res => setTimeout(res, 500));
                const data = getGenieResponse(message);
                setMessages(prev => [...prev, { ...data, id: Date.now() + 1, type: 'assistant' }]);
                setIsLoading(false);
            };

            const handleImageClickInAlbum = (images, clickedIndex) => {
                setGalleryImages(images);
                setCurrentImageIndex(clickedIndex);
                setIsImageViewerOpen(true);
            };

            const openPhotoAlbum = (media) => {
                if (media && media.length > 0) {
                    setPhotoAlbumMedia(media);
                    setIsPhotoAlbumOpen(true);
                }
            };

             useEffect(() => {
                setMessages([
                    {id: 1, type: 'assistant', content: 'ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”? ì•„ë˜ëŠ” ëª‡ ê°€ì§€ ì˜ˆì‹œ ì§ˆë¬¸ì…ë‹ˆë‹¤.\n- "MSC ë²¨ë¦¬ì‹œë§ˆ ë³´ì—¬ì¤˜"\n- "í™ì½© ê³µí•­ì—ì„œ ì¹´ì´íƒ í¬ë£¨ì¦ˆ í„°ë¯¸ë„ê¹Œì§€ ì–´ë–»ê²Œ ê°€"\n- "ë‚´ ìœ„ì¹˜ ê·¼ì²˜ ë§›ì§‘"'},
                ]);
            }, []);

            return (
                <div className="h-screen w-screen sm:h-[95vh] sm:max-h-[800px] sm:w-[450px] flex flex-col relative shadow-2xl bg-white mx-auto sm:rounded-2xl">
                    <div className="bg-blue-600 text-white p-4 rounded-t-2xl flex items-center justify-center">
                        <h1 className="text-xl font-bold">AI í¬ë£¨ì¦ˆ ê°€ì´ë“œ ì§€ë‹ˆ ğŸ§â€â™‚ï¸</h1>
                    </div>
                    <ChatUI messages={messages} isLoading={isLoading} scrollRef={scrollRef} onImageClick={handleImageClickInAlbum} onOpenPhotoAlbum={openPhotoAlbum} />
                    <div className="p-4 bg-white border-t border-gray-200 rounded-b-2xl">
                        <form onSubmit={(e) => { e.preventDefault(); const input = e.target.elements.message; handleSendMessage(input.value); input.value = ''; }} className="flex gap-2">
                            <input type="text" name="message" placeholder="ì§€ë‹ˆì—ê²Œ ë©”ì‹œì§€ ë³´ë‚´ê¸°..." className="flex-1 p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" autoComplete="off" />
                            <button type="submit" className="px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400" disabled={isLoading}>ì „ì†¡</button>
                        </form>
                    </div>
                     <PhotoAlbumModal isOpen={isPhotoAlbumOpen} onClose={() => setIsPhotoAlbumOpen(false)} media={photoAlbumMedia} onImageClick={(index) => handleImageClickInAlbum(photoAlbumMedia, index)} />
                     <ImageViewerModal isOpen={isImageViewerOpen} onClose={() => setIsImageViewerOpen(false)} images={galleryImages} currentIndex={currentImageIndex} setCurrentIndex={setCurrentImageIndex} />
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>